---
layout : post
categories : vision, AI
title : 에지와 영역
tags : [vision, AI]
date-string : March 26, 2024
---

# 에지와 영역

## 에지와 영역은 쌍대 문제, 다른 접근방법 사용
- 에지와 영역은 같은 문제를 다른 방향으로 푼다고 볼 수 있음
- 에지 : 특성이 다른 곳 검출
- 영역 : 유사한 화소를 묶음

## 사람은 의미분할에 능숙
- 사람은 머리속에 기억된 물체 모델을 활용하여 의미 분할

## 에지 검출 알고리즘
### 미분
- 변수 x가 미세하게 증가했을 때 함수 변화량을 측정
- 미분을 디지털 영상에 적용하면 한 화소가 변할때 얼마나 바뀌는가로 변함
- 실제 구현은 필터 u로 컨볼루션(u를 에지 연산자로 부름)

### 에지 연산자
- 현실 세계의 램프 에지
  - 명암이 몇 화소에 걸쳐 변함

- 1차 미분과 2차 미분
- 2차미분
- 1차미분과 2차미분 차이
  - 2차미분을 하면 이 식을 구하는 필터를 한번에 구할 수 있음


### 에지 검출
- 1차 미분에서 봉우리 찾기
- 2차 미분에서 영교차 찾기

### 1차 미분에 기반한 에지 연산자
- 실제 영상에 있는 잡음을 흡수하기 위해 크기가 2인 필터를 크기 3으로 확장
- 또한 1차원을 2차원으로 확장

### 에지 강도와 에지 방향
- 에지 강도
- 그레이디언트 방향
- 그레이디언트 방향과 에지 방향은 270도 차이

## 캐니 에지
### 에지 검출을 최적화 문제로 품
- 최소 오류율, 위치 정확도, 한 두께라는 세 가지 기준으로 목적 함수 정의
- 한 두께를 위해 비최대 억제 적용
- 거짓 긍정을 줄이기 위해 두 개의 이력 임계값 사용
  - 에지 강도가 $T_{high}$ 이상인 에지에서 에지 추적 시작
  - 이후 추적은 $T_{low}$ 이상인 에지를 대상으로 진행

### 최소 오류율 : 거짓 긍정
- 실제로는 부정, 긍정으로 판단
- 에지 검출에서 에지가 아니지만 에지로 판단

### 위치 정확도
- 에지가 참 에지와 가까워야함
- 검출기에 의한 에지와 진짜 에지의 중심거리가 최소가 되어야함

### 한 두께
- 참 에지 점에 대해 한 점만을 반환 해야함
- 에지 점이 하나만 있는 곳에서 여러개를 식별하지 않아야 함

### 4단계 연산을 거침
- 1단계 - 가우시안 필터링 : 블러링을 통해 잡음을 제거
- 2단계 - 그래디언트 계산 : 소벨 마스크 필터링을 통해 그래디언트의 크기와 방향을 계산
- 3단계 - 비최대 억제 : 그래디언트 크기가 국지적으로 최대인 픽셀을 에지 픽셀로 설정
- 4단계 - 히스테리시스 에지 트래킹 : 2개의 임계값을 사용
  - 높은 임계값 $T_{high}$ 보다 크면 최종적인 에지로 판단
  - 낮은 임계값 $T_{low}$ 보다 낮으면 에지가 아닌 것으로 판단
  - 두 값 사이에 있는 픽셀은 연결된 에지 픽셀이 강한 에지(높은 임계값 이상)인 경우에 에지로 판단

### 에지 검출 방법은 명암 변화에만 의존
- 물체 경계에 나타난 에지와 그림자로 인해 발생한 가짜 에지 구분에 약함
- 인접한 두 물체가 비슷한 명암을 가지면 구분이 힘듬
- 사람의 경우에는 물체의 모양과 겉모습을 동시에 사용
  - 주위 환경의 변화에도 성능 저하가 적음
- 에지 검출에 대한 연구는 캐니 이후 뚜렷한 개선이 없음

## 직선 검출

### 에지 맵에서 에지는 1 그 외 화소는 0
- 에지를 명시적으로 연결하여 경계선을 찾고 직선으로 변환
- 이후 처리 단계인 물체 표현이나 인식에 유리

### 8-연결된 에지 화소를 연결해 경계(윤곽)선 구성

### 경계선 검출
- canny 방법으로 에지 맵 생성
- 에지 맵에서 경계선을 찾아서 저장
  - 경계선을 찾을 이미지를 넣으면 바깥 경계와 안쪽 경계를 계층적으로 찾아줌
  - RETR_LIST는 바깥 경계인 에지에 해당하는 픽셀의 위치를 리스트로 만듬
  - CHAIN_APPROX_NONE은 에지로 분류된 모든 픽셀의 위치를 기록

- drawContours에지로 설정된 경계선을 그려줌
  - 이미지, 경계선 값(list), 경계선 인덱스, 색상, 두께의 값을 입력
  - 경계선 인덱스 -1은 경계선 값으로 선택된 값 전체를 이미지 위에 그려줌

### 허프 변환
- 허프 변환은 끊긴 에지를 모아 직선 또는 원 등을 검출
- 직선 검출의 원리
  - 각각의 점에 대해 (b, a)광간에 직선 $b = -ax_i + y_i$를 그림
  - (b,a)공간에서 직선이 만나는 점을 절편과 기울기로 취함. 만나는 점은 투표로 알아냄