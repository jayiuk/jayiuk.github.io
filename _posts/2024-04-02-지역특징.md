---
layout : post
categories : vision, AI
title : 지역특징
tags : [vision, AI]
date-string : April 02, 2024
---

# 지역 특징

## 발상
### 물체 추적에서 대응점 찾기
- 반복성이 뛰어난 특징 필요

### 지역 특징의 발상
- 좁은 지역을 보고 특징점 여부 결정
- 물체의 실제 모퉁이에 위치해야 한다는 생각을 바꿈
- 반복성을 더 중요하게 취급하는 발상의 전환

### 지역 특징의 표현
- (위치, 스케일, 방향, 특징기술자)
- 위치와 스케일은 검출 단계에서
- 방향과 특징 기술자는 기술 단계에서

### 지역 특징의 조건
- 반복성 : 같은 위치에서 높은 확률로 검출
- 불변성 : 물체에 변환이 가해져도 특징 기술자의 값이 비숫해야됨
- 분별력 : 물체의 다른 곳에서 추출된 특징과 차이가 있어야 됨
- 지역성 : 작은 지역을 중심으로 특징 벡터 추출로 가림에 강건한 매칭이 가능
- 적당한 양 : 특징점이 많으면 정확한 추적이 가능하지만 계산이 과다해짐
- 계산 효율 : 실시간 추적의 경우 빠른 계산이 필요

### 이들 조건과 상충 관계 존재
- 응용에 따라 적절히 조절할 필요가 있음
  - 적당한 특징점 vs 계산 효율
  - 분별력 vs 지역성

## 이동과 회전 불변한 지역 특징

### 모라벡 알고리즘
- 여러 방향에 대해 색상 변화를 측정하는 제곱차의 합이라는 식 제안
$$S(v, u) = \sum\sum w(y, x)(f(y + v, x + u) - f(y, x))^2$$

#### 식의 의도
- c는 모든 변화가 없어 S맵의 모든 요소가 0. 지역 특징으로 자격이 없음
- b는 수평 방향만 변화가 있어 S맵의 좌우 이웃만 큰 값. 지역 특징으로 부족
- a는 모든 방향으로 변화가 있어 S맵의 8이웃 모두 큰 값. 지역 특징으로 훌륭함

#### 특징 가능성 값 측정
- S맵에서 상하좌우 네 이웃 화소의 최소값
$$C = min(S(0, 1), S(0, -1), S(1, 0), S(-1, 0))$$

### 해리스 특징점
#### 모라벡은 지역 특징의 길을 열었지만 현실적이지 않음
- 실제 세계의 영상은 상하좌우 이웃만 보는 것으로 부족
- 해리스의 확장
- 잡음에 대처하기 위해 가우시안 적용하여 가중치 제곱차의 합을 식으로 정의
$$S(v, u) = \sum_y \sum_x G(y, x)(f(y + v, x + u) - f(y, x))^2$$
- 테일러 급수

#### 2차 모멘트 행렬을 통한 특징점 검출
- 테일러 확장으로 식 성립
$$f(y+v, x+u) \tilde{=} f(y,x)+vd_y(y,x)+ud_x(y,x)$$

#### 2차 모멘트 행렬 A의 특성
- (v, u)는 실수 가능
- A는 하소 주위의 영상 구조를 표현하기 때문에 A만 분석하면 지역 특징 여부 알 수 있음((v, u)를 변화시키면서 맵을 생성할 팰요 없음)

#### 해리스의 특징 가능성 계산
- A의 고유값 $$\lambda_1, \lambda_2$$
$$C = \lambda_1 \lambda_2 - k(\lambda_1 + \lambda_2)^2$$

$$C = (pq - r^2)-k(p+q)^2$$
$$A = \begin{pmatrix}
        p & r \\
        r & q
        \end{pmatrix}$$

#### 해리스 특징점의 분석
- 물체의 실제 모퉁이 뿐 아니라 블롭에서도 검출
- 이후에는 모퉁이 대신 특정점 또는 관심점으로 부름
- 이동과 회전에 불변
- 스케일에는 불변 아님

## 스케일 불변한 지역 특징
### 사람은 스케일 불변인 특징 사용
- 거리에 상관없이 같은 물체를 같다고 인식
- 거리에 따라 세세한 내용에만 차이가 있음

### 스케일 공간 이론은 컴퓨터 비전에 스케일 불변 가능성 열어줌

### 다중 스케일 영상 구현하는 방법
- 입력은 영상 한 장. 여러 거리에서 보았을 때 나타나는 현상을 흉내 내는 수밖에 없음
- 가우시안 스무딩과 피라미드 방법

### 가우시안 스무딩은 스케일을 연속값으로 조절할 수 있는 장점

### 스케일 공간의 미분은 정규 라플라시안 사용

## SIFT

### 구축

#### 1단계 : 다중 스케일 영상 구축
- 가우시안 스무딩과 피라미드 방법을 결합해 사용

#### 2단계 : 다중 스케일 영상에 미분 적용
- 식의 정규 라플라시안 사용. 시간이 많이 걸려 유사한 DOG 사용
- DOG는 가우시안 영상은 이미 있고 이웃한 가우시안을 빼면 되기 때문에 획기적으로 빠름

#### 3단계 : 극점 검출
- 3차원에서 비최대 억제 적용

#### 특징점은 (y, x, o, i)로 표현
- (y, x)는 위치 표현, 옥타브 o와 DOG 번호 i는 스케일 표현

### SIFT 기술자

#### 특징점 주위를 살펴 풍부한 정보를 가진 기술자 추출
- 불변성 달성이 매우 중요
#### 기술자 추출 알고리즘
- a와 i로 가장 가까운 가우시안 영상을 결정, 거기서 기술자를 추출하여 스케일 불변성 달성
- 기준 방향을 정하고 기준 방향을 중심으로 특징을 추출하여 회전 불변성 달성 -> 주변을 10도 간격으로 양자화하여 히스토그램을 만들고 최대값에서 세타 추출
- 특성 기술자 x는 세타를 중심으로 16X16의 윈도우의 각 칸을 다시 4X4로 나누고 그래디언트를 계산 방향을 8개로 양자화하여 히스토그램을 그릴 때 각 방향의 크기를